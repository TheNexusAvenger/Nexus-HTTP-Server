



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://thenexusavenger.github.io/Nexus-HTTP-Server/getting-started/split-requests/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>Split Requests - Nexus HTTP Server Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.1b62728e.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="light-blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#protocol" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://thenexusavenger.github.io/Nexus-HTTP-Server" title="Nexus HTTP Server Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Nexus HTTP Server Documentation
            </span>
            <span class="md-header-nav__topic">
              
                Split Requests
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/TheNexusAvenger/Nexus-HTTP-Server/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    TheNexusAvenger/Nexus-HTTP-Server
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://thenexusavenger.github.io/Nexus-HTTP-Server" title="Nexus HTTP Server Documentation" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Nexus HTTP Server Documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/TheNexusAvenger/Nexus-HTTP-Server/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    TheNexusAvenger/Nexus-HTTP-Server
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Getting Started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../standard-server/" title="Standard Server" class="md-nav__link">
      Standard Server
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Split Requests
      </label>
    
    <a href="./" title="Split Requests" class="md-nav__link md-nav__link--active">
      Split Requests
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#protocol" class="md-nav__link">
    Protocol
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#standalone" class="md-nav__link">
    Standalone
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sending-split-requests" class="md-nav__link">
    Sending Split Requests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-example" class="md-nav__link">
    Code Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#protocol" class="md-nav__link">
    Protocol
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#standalone" class="md-nav__link">
    Standalone
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sending-split-requests" class="md-nav__link">
    Sending Split Requests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-example" class="md-nav__link">
    Code Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/TheNexusAvenger/Nexus-HTTP-Server/edit/master/docs/getting-started/split-requests.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Split Requests</h1>
                
                <div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Split requests should not be used for public-facing
applications. No protections are provided that
would result in out-of-memory errors from malicious
requests.</p>
</div>
<p>Split requests intended to be used for cases where
a lot of data needs to be transferred via POST requests,
and this amount of data may be beyond what the client
can send or recieve, like Roblox Studio.</p>
<h2 id="protocol">Protocol</h2>
<p>The protocol is able to have split requests and split
responses. For this example, a client is only able to
send 6 characters in the body and the server is configured
to only send back 4 characters. The POST body sent is then
echoed back without modification.</p>
<h3 id="standalone">Standalone</h3>
<p>If no split-request parameters are speicifed, the request
is treated as non-split and the response is sent back
complete.</p>
<div class="codehilite"><pre><span></span><span class="err">POST http://localhost:8080 &quot;Test1 Test2 Test3&quot;</span>
<span class="err">     HTTP 200 &quot;Test1 Test2 Test3&quot;</span>
</pre></div>


<p>This implementation allows for clients without needing
to get around limits to not need to use the implementation,
such as external end-to-end testing of applications.</p>
<h3 id="sending-split-requests">Sending Split Requests</h3>
<p>Split requests take data as URL arguments, which include the following:
- <code>maxPackets</code> - The total packets that will be sent
- <code>requestId</code> - The id of the packet to send (not sent in the first request)
- <code>packet</code> - The id of the pakcet to send, starting at 0 (optional in the first request)</p>
<p>When a request is incomplete (not all packets sent), a JSON
string is returned with the following
- <code>status</code> - <code>"incomplete"</code>
- <code>id</code> - The value to use in <code>requestId</code> to continue the request</p>
<p>When a response is complete, the following is returned:
- <code>status</code> - <code>"success"</code>
- <code>id</code> - The value to use in <code>responseId</code> for getting responses
- <code>currentPacket</code> - The id of the packet, starting at 0.
- <code>maxPackets</code> - The total packets to recieve
- <code>packet</code> - The data in the pakcet</p>
<p>For getting additional responses (maxPackets &gt; 1), the following
arguments can be used:
- <code>getResponse = true</code> - Specifies that responses are being fetched
- <code>responseId</code> - The response id to read from
- <code>packet</code> - The packet id to get from the response, starting at 0</p>
<p>For the example above, the requests would look like the following:</p>
<div class="codehilite"><pre><span></span><span class="err">POST http://localhost:8080?maxPackets=3 &quot;Test1 &quot;</span>
<span class="err">     HTTP 200 &quot;{&quot;status\&quot;:\&quot;incomplete\&quot;,\&quot;id\&quot;:0}&quot;</span>
<span class="err">POST http://localhost:8080?maxPackets=3&amp;packet=1&amp;requestId=0 &quot;Test2 &quot;</span>
<span class="err">     HTTP 200 &quot;{&quot;status\&quot;:\&quot;incomplete\&quot;,\&quot;id\&quot;:0}&quot;</span>
<span class="err">POST http://localhost:8080?maxPackets=3&amp;packet=2&amp;requestId=0 &quot;Test 3&quot;</span>
<span class="err">     HTTP 200 &quot;{&quot;status\&quot;:\&quot;success\&quot;,\&quot;id\&quot;:0,\&quot;currentPacket\&quot;:0,\&quot;maxPackets\&quot;:4 \&quot;packet\&quot;:\&quot;Test1\&quot;}&quot;</span>
<span class="err">GET http://localhost:8080?getResponse=true&amp;responseId=0&amp;packet=1 &quot;Test 3&quot;</span>
<span class="err">     HTTP 200 &quot;{&quot;status\&quot;:\&quot;success\&quot;,\&quot;id\&quot;:0,\&quot;currentPacket\&quot;:1,\&quot;maxPackets\&quot;:4,\&quot;packet\&quot;:\&quot; Tes\&quot;}&quot;</span>
<span class="err">GET http://localhost:8080?getResponse=true&amp;responseId=0&amp;packet=2 &quot;Test 3&quot;</span>
<span class="err">     HTTP 200 &quot;{&quot;status\&quot;:\&quot;success\&quot;,\&quot;id\&quot;:0,\&quot;currentPacket\&quot;:2,\&quot;maxPackets\&quot;:4,\&quot;packet\&quot;:\&quot;t2 T\&quot;}&quot;</span>
<span class="err">GET http://localhost:8080?getResponse=true&amp;responseId=0&amp;packet=3 &quot;Test 3&quot;</span>
<span class="err">     HTTP 200 &quot;{&quot;status\&quot;:\&quot;success\&quot;,\&quot;id\&quot;:0,\&quot;currentPacket\&quot;:3,\&quot;maxPackets\&quot;:4,\&quot;packet\&quot;:\&quot;est3\&quot;}&quot;</span>
</pre></div>


<p>After a response is fully retrieved, it is removed to save memory.
This however does cause a vulnerability since malicous (or just incorrect
usage of the protocol) will result in a memory leak. Same goes for sending
requests since they need to be stored and combined. Additionally, there
is no checks for the size, so denial of service attacks can be performed
by sending large, incomplete requests that won't get cleared. This system
is not intended for publicly facing applications.</p>
<h3 id="code-example">Code Example</h3>
<p>The code from the previous example can be tweaked to work with this (ignoring
the limit of sending back 4 characters) by using the base class <code>SplitClientRequestHandler</code>
for the client handler and using <code>SplitRequestHandler</code> which ensures that
the <code>GET</code> handlers are added.</p>
<div class="codehilite"><pre><span></span><span class="k">using</span> <span class="nn">Nexus.Http.Server.Http.Request</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Nexus.Http.Server.Http.Response</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Nexus.Http.Server.Http.Server</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Nexus.Http.Server.SplitHttp.Request</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Demo</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">class</span> <span class="nc">Handler</span> <span class="p">:</span> <span class="n">SplitClientRequestHandler</span>
        <span class="p">{</span>
            <span class="cm">/*</span>
<span class="cm">             * Returns a response for a given complete request.</span>
<span class="cm">             */</span>
            <span class="k">public</span> <span class="k">override</span> <span class="n">HttpResponse</span> <span class="nf">GetCompleteResponseData</span><span class="p">(</span><span class="n">HttpRequest</span> <span class="n">request</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">.</span><span class="n">CreateSuccessResponse</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">GetBody</span><span class="p">());</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Create the request handlers.</span>
            <span class="kt">var</span> <span class="n">handler</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SplitRequestHandler</span><span class="p">();</span>
            <span class="n">handler</span><span class="p">.</span><span class="n">RegisterHandler</span><span class="p">(</span><span class="s">&quot;POST&quot;</span><span class="p">,</span><span class="s">&quot;/&quot;</span><span class="p">,</span><span class="k">new</span> <span class="n">Handler</span><span class="p">());</span>
            <span class="n">handler</span><span class="p">.</span><span class="n">RegisterHandler</span><span class="p">(</span><span class="s">&quot;POST&quot;</span><span class="p">,</span><span class="s">&quot;/test&quot;</span><span class="p">,</span><span class="k">new</span> <span class="n">Handler</span><span class="p">());</span>

            <span class="c1">// Create and start the server.</span>
            <span class="kt">var</span> <span class="n">server</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HttpServer</span><span class="p">(</span><span class="m">8080</span><span class="p">,</span><span class="n">handler</span><span class="p">);</span>
            <span class="n">server</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../standard-server/" title="Standard Server" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Standard Server
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>